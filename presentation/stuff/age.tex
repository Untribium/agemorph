\usetikzlibrary{arrows}
\usetikzlibrary{fit}

\definecolor{beige}{rgb}{0.93,0.92,0.88}

\tikzset{
	pics/conv/.style n args={5}{
		code = {
			\draw[draw=black, fill=beige] (#1, #2) rectangle ++ (1, 3) node[rotate=90, pos=0.5] {\large $#3 \times #4 \times #3$};
			\node[below] at (#1+0.5, #2+3.1) {\large #5};
		}
	},
	pics/text/.style n args={5}{
		code = {
			\draw[draw=black, fill=beige] (#1, #2) rectangle ++ (1, 3) node[rotate=#4, pos=0.5] {\huge #3};
			\node[below] at (#1+0.5, #2+3.1) {\large #5};
		}
	},
	trap/.style = {
		draw,
		text width=3cm,
		align=flush center, 
		trapezium, 
		rotate=90, 
		minimum height=4cm, 
		minimum width=0cm, 
		trapezium stretches, 
		fill=beige,
		inner xsep=0pt
	}
}

\begin{tikzpicture}[scale=0.36, line/.style={>=latex}, every node/.style={scale=0.36}, y=-1cm] 


	\pic{text={0}		{28.5}	{$x\vphantom{xyt}$}	{0}	{}};
	
	\draw[->] (1, 30) -- (3, 30);
	
	\node[trap, trapezium angle=155] at (5, 30) {\Large Encoder};
	\node[trap, trapezium angle=25] at (9, 30) {\Large Decoder};
	
	\draw [
	    thick,
	    decoration={
		brace,
		amplitude=5pt,
		raise=32.5pt,
		mirror
	    },
	    decorate
	] (2.75, 30) -- (22.25, 30);
	
	\node [] at (12, 34.25) {\Large Generator};

	\draw[->] (11, 30) -- (12, 30);
	
	\pic{text={12}		{28.5}	{$v\vphantom{xyt}$}	{0}	{}};
	\draw[->] (13, 30) -- (14, 30);

	\pic{text={12}		{23.5}	{\LARGE $\vec 0\vphantom{xyt}$}	{0}	{}};
	\draw[->] (13, 25) -- (14, 25);
		
	\pic{text={14}	{23.5}	{$\circ\vphantom{xyt}$}	{0}	{}};
	\pic{text={15}	{23.5}	{$\circ\vphantom{xyt}$}	{0}	{}};
	\pic{text={16}	{23.5}	{$\circ\vphantom{xyt}$}	{0}	{}};

	\pic{text={14}	{28.5}	{}	{0}	{}};
	\pic{text={15}	{28.5}	{}	{0}	{}};
	\pic{text={16}	{28.5}	{}	{0}	{}};
	
	\draw[<-, dashed] (14.5, 26.5) -- (14.5, 28.5);
	\draw[<-, dashed] (15.5, 26.5) -- (15.5, 28.5);
	\draw[<-, dashed] (16.5, 26.5) -- (16.5, 28.5);

    	\node [fill=white, inner sep=5pt] at (15.5, 27.5) {\Large $t = 01101_2$};
    	
	\node [fill=beige, inner sep=5pt] at (15.5, 29.25) {\Large scaling};
	\node [fill=beige, inner sep=5pt] at (15.5, 30.00) {\Large \&};
    	\node [fill=beige, inner sep=5pt] at (15.5, 30.75) {\Large squaring};

	\draw[->] (17, 25) -- (19, 30);
	
	\pic{text={19}	{28.5}	{\LARGE $\Phi^{(t)}$}	{90}	{}};

	\draw[->] (20, 30) -- (21, 30);
	\draw[->] (2, 30) -- (2, 35) -- (21.5, 35) -- (21.5, 31.5);
	
	\pic{text={21}		{28.5}	{$\circ\vphantom{xyt}$}	{0}	{}};
	
	\draw[->] (22, 30) -- (24, 30);
	
	\pic{text={24}		{28.5}	{$\hat y$}	{0}	{}};
	\pic{text={25}		{28.5}	{$x\vphantom{xyt}$}	{0}	{}};

	%\pic{text={23}		{22.5}	{$t\vphantom{xyt}$}	{0}	{}};
	\pic{text={24}		{22.5}	{$y\vphantom{xyt}$}	{0}	{}};
	\pic{text={25}		{22.5}	{$x\vphantom{xyt}$}	{0}	{}};
	
	\draw[->] (26, 24) -- (28, 24.5);
	\draw[->] (26, 30) -- (28, 26.5);
	
	\node [rotate=90] at (27, 26) {\Large alternating};
	
	\draw[->] (26, 30) -- (28, 33.5);

	\node[trap, trapezium angle=155] at (30, 25.5) {\Large Critic};
	
	\draw[->] (32, 25.5) -- (34, 25.5);
	
	\pic{text={34}		{24}	{\Large $D(x, y)$}	{90}	{}};
	
	\node[trap, trapezium angle=155] at (30, 33.5) {\Large Critic};

	\node [fill=beige, inner sep=5pt, rotate=90, align=center] at (30, 33.5) {\Large Regressor \\[4pt] \Large (pre-trained)};
	
	\draw[->] (32, 33.5) -- (34, 33.5);
	
	\pic{text={34}		{32}	{\Large $R(y)$}	{90}	{}};
	
\end{tikzpicture}

\vspace{30pt}
