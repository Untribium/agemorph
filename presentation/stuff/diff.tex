\usetikzlibrary{arrows}
\usetikzlibrary{fit}

\definecolor{beige}{rgb}{0.93,0.92,0.88}

\tikzset{
	pics/conv/.style n args={5}{
		code = {
			\draw[draw=black, fill=beige] (#1, #2) rectangle ++ (1, 3) node[rotate=90, pos=0.5] {\large $#3 \times #4 \times #3$};
			\node[below] at (#1+0.5, #2+3.1) {\large #5};
		}
	},
	pics/text/.style n args={5}{
		code = {
			\draw[draw=black, fill=beige] (#1, #2) rectangle ++ (1, 3) node[rotate=#4, pos=0.5] {\huge #3};
			\node[below] at (#1+0.5, #2+3.1) {\large #5};
		}
	},
	trap/.style = {
		draw,
		text width=3cm,
		align=flush center, 
		trapezium, 
		rotate=90, 
		minimum height=4cm, 
		minimum width=0cm, 
		trapezium stretches, 
		fill=beige
	}
}

\begin{tikzpicture}[scale=0.36, line/.style={>=latex}, every node/.style={scale=0.36}, y=-1cm] 


	\pic{text={0}		{28.5}	{$x\vphantom{xyt}$}	{0}	{}};
	
	\draw[->] (1, 30) -- (3, 30);
	
	\node[trap, trapezium angle=155] at (5, 30) {\Large Encoder};
	\node[trap, trapezium angle=25] at (9, 30) {\Large Decoder};
	
	\draw [
	    thick,
	    decoration={
		brace,
		amplitude=5pt,
		raise=32.5pt
	    },
	    decorate
	] (2.75, 30) -- (21.25, 30);
	
	\node [] at (12, 25.75) {\Large Generator};

	\draw[->] (11, 30) -- (12, 30);
	
	\pic{text={12}		{28.5}	{$v\vphantom{xyt}$}	{0}	{}};

	\draw[->] (13, 30) -- (14, 30);
	
	\pic{text={14}	{28.5}	{}	{0}	{}};
	\pic{text={15}	{28.5}	{}	{0}	{}};
	\pic{text={16}	{28.5}	{}	{0}	{}};
	
    	\node [fill=beige, inner sep=5pt] at (15.5, 29.25) {\Large scaling};
	\node [fill=beige, inner sep=5pt] at (15.5, 30.00) {\Large \&};
    	\node [fill=beige, inner sep=5pt] at (15.5, 30.75) {\Large squaring};

	\draw[->] (17, 30) -- (18, 30);
	
	\pic{text={18}	{28.5}	{$\Phi$}	{0}	{}};

	\draw[->] (19, 30) -- (20, 30);
	\draw[->] (2, 30) -- (2, 34) -- (20.5, 34) -- (20.5, 31.5);
	
	\pic{text={20}		{28.5}	{$\circ\vphantom{xyt}$}	{0}	{}};
	
	\draw[->] (21, 30) -- (23, 30);
	
	\pic{text={23}		{28.5}	{$\hat y$}	{0}	{}};
	\pic{text={24}		{28.5}	{$x\vphantom{xyt}$}	{0}	{}};

	\pic{text={23}		{22.5}	{$y\vphantom{xyt}$}	{0}	{}};
	\pic{text={24}		{22.5}	{$x\vphantom{xyt}$}	{0}	{}};
	
	\draw[->] (25, 24) -- (27, 26);
	\draw[->] (25, 30) -- (27, 28);
    
	\node [rotate=90] at (26, 27) {\Large alternating};

	\node[trap, trapezium angle=155] at (29, 27) {\Large Critic};
	
	\draw[->] (31, 27) -- (33, 27);
	
	\pic{text={33}		{25.5}	{\Large $D(x, y)$}	{90}	{}};
	

\end{tikzpicture}

\vspace{30pt}
